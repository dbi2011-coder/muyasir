// ============================================
// Ù†Ø¸Ø§Ù… Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
// ============================================

// ØªÙ‡ÙŠØ¦Ø© Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
function initializeDashboard() {
    console.log('ğŸ  Ø¨Ø¯Ø¡ ØªÙ‡ÙŠØ¦Ø© Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…...');
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
    const user = checkAuth();
    if (!user) {
        console.log('âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„');
        showAuthNotification('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹', 'warning');
        setTimeout(() => {
            window.location.href = '../../index.html';
        }, 2000);
        return;
    }
    
    console.log(`âœ… ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${user.name} (${user.role})`);
    
    // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    updateDashboardUI(user);
    
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
    loadDashboardData();
    
    console.log('âœ… ØªÙ… Ø¥Ø¹Ø¯Ø§Ø¯ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ù†Ø¬Ø§Ø­');
}

// ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
function updateDashboardUI(user) {
    console.log('ğŸ‘¤ ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…...');
    
    const userNameElement = document.getElementById('userName');
    const userAvatarElement = document.getElementById('userAvatar');
    
    if (userNameElement) {
        userNameElement.textContent = user.name;
        console.log(`âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${user.name}`);
    } else {
        console.log('âš ï¸ Ø¹Ù†ØµØ± Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
    }
    
    if (userAvatarElement) {
        userAvatarElement.textContent = user.name.charAt(0);
        console.log(`âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ù…Ø²ÙŠØ©: ${user.name.charAt(0)}`);
    } else {
        console.log('âš ï¸ Ø¹Ù†ØµØ± Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ù…Ø²ÙŠØ© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
    }
}

// ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
function loadDashboardData() {
    console.log('ğŸ“Š Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…...');
    
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
    setTimeout(() => {
        const users = JSON.parse(localStorage.getItem('users') || '[]');
        const teachers = users.filter(u => u.role === 'teacher');
        const students = users.filter(u => u.role === 'student');
        
        console.log(`ğŸ‘¨â€ğŸ« Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ†: ${teachers.length}`);
        console.log(`ğŸ‘¨â€ğŸ“ Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨: ${students.length}`);
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©
        updateStatElement('teachersCount', teachers.length);
        updateStatElement('studentsCount', students.length);
        updateStatElement('activeSessions', Math.floor(Math.random() * 10) + 1);
        updateStatElement('pendingActions', Math.floor(Math.random() * 5));
        
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø£Ø®ÙŠØ±
        loadRecentActivity();
        
        console.log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…');
    }, 1000);
}

// ØªØ­Ø¯ÙŠØ« Ø¹Ù†ØµØ± Ø§Ù„Ø¥Ø­ØµØ§Ø¡
function updateStatElement(elementId, value) {
    const element = document.getElementById(elementId);
    if (element) {
        element.textContent = value;
        console.log(`ğŸ“ˆ ${elementId}: ${value}`);
    } else {
        console.log(`âš ï¸ Ø¹Ù†ØµØ± ${elementId} ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯`);
    }
}

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø£Ø®ÙŠØ±
function loadRecentActivity() {
    const activityList = document.getElementById('activityList');
    if (!activityList) {
        console.log('âš ï¸ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù†Ø´Ø§Ø· ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©');
        return;
    }

    console.log('ğŸ“ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø£Ø®ÙŠØ±...');

    const activities = [
        {
            icon: 'ğŸ‘¨â€ğŸ«',
            title: 'ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„Ù… Ø¬Ø¯ÙŠØ¯',
            time: 'Ù…Ù†Ø° 5 Ø¯Ù‚Ø§Ø¦Ù‚',
            color: '#3498db'
        },
        {
            icon: 'ğŸ“',
            title: 'Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ø§Ù†Ø¶Ù… Ù„Ù„Ù†Ø¸Ø§Ù…',
            time: 'Ù…Ù†Ø° Ø³Ø§Ø¹Ø©',
            color: '#27ae60'
        },
        {
            icon: 'ğŸ“Š',
            title: 'ØªÙ‚Ø±ÙŠØ± Ø´Ù‡Ø±ÙŠ ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡',
            time: 'Ù…Ù†Ø° 3 Ø³Ø§Ø¹Ø§Øª',
            color: '#f39c12'
        },
        {
            icon: 'âš ï¸',
            title: 'Ø­Ø³Ø§Ø¨ Ù…Ø¹Ù„Ù… ØªÙ… ØªØ¹Ù„ÙŠÙ‚Ù‡',
            time: 'Ù…Ù†Ø° ÙŠÙˆÙ…',
            color: '#e74c3c'
        }
    ];

    activityList.innerHTML = activities.map(activity => `
        <div class="activity-item">
            <div class="activity-icon" style="background: ${activity.color}20; color: ${activity.color}">
                ${activity.icon}
            </div>
            <div class="activity-content">
                <div class="activity-title">${activity.title}</div>
                <div class="activity-time">${activity.time}</div>
            </div>
        </div>
    `).join('');
    
    console.log(`âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ ${activities.length} Ù†Ø´Ø§Ø·`);
}

// ============================================
// Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ
// ============================================

function setupSidebar() {
    console.log('ğŸ—‚ï¸ Ø¬Ø§Ø±ÙŠ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ...');
    
    const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
    const sidebar = document.querySelector('.sidebar');
    
    if (mobileMenuBtn && sidebar) {
        mobileMenuBtn.addEventListener('click', function() {
            sidebar.classList.toggle('active');
            console.log('ğŸ“± ØªÙ… ØªØ¨Ø¯ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ');
        });
    }
    
    // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§ (Ù„Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù…Ø­Ù…ÙˆÙ„Ø©)
    document.addEventListener('click', function(event) {
        if (window.innerWidth <= 768 && sidebar && sidebar.classList.contains('active')) {
            if (!sidebar.contains(event.target) && !mobileMenuBtn.contains(event.target)) {
                sidebar.classList.remove('active');
                console.log('ğŸ“± ØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ');
            }
        }
    });
}

// ============================================
// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø©
// ============================================

// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„Ù‡Ø§
document.addEventListener('DOMContentLoaded', function() {
    console.log('ğŸ“„ ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©ØŒ Ø¨Ø¯Ø¡ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©...');
    
    // ØªÙ‡ÙŠØ¦Ø© Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
    initializeDashboard();
    
    // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ
    setupSidebar();
    
    // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªÙ†Ù‚Ù„Ø©
    setupMobileMenu();
    
    console.log('ğŸ‰ ØªÙ… Ø§ÙƒØªÙ…Ø§Ù„ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø©');
});

// Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªÙ†Ù‚Ù„Ø©
function setupMobileMenu() {
    console.log('ğŸ“± Ø¬Ø§Ø±ÙŠ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªÙ†Ù‚Ù„Ø©...');
    
    const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
    if (mobileMenuBtn) {
        console.log('âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªÙ†Ù‚Ù„Ø©');
    } else {
        console.log('âš ï¸ Ø²Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªÙ†Ù‚Ù„Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
    }
}

// ============================================
// Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø©
// ============================================

// ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
function refreshDashboard() {
    console.log('ğŸ”„ Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ« Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…...');
    showAuthNotification('Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...', 'info');
    
    loadDashboardData();
    
    setTimeout(() => {
        showAuthNotification('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
        console.log('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…');
    }, 1500);
}

// Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© ØªØ±Ø­ÙŠØ¨
function showWelcomeMessage(user) {
    if (user) {
        const hour = new Date().getHours();
        let greeting;
        
        if (hour < 12) {
            greeting = 'ØµØ¨Ø§Ø­ Ø§Ù„Ø®ÙŠØ±';
        } else if (hour < 18) {
            greeting = 'Ù…Ø³Ø§Ø¡ Ø§Ù„Ø®ÙŠØ±';
        } else {
            greeting = 'Ù…Ø³Ø§Ø¡ Ø§Ù„Ø®ÙŠØ±';
        }
        
        showAuthNotification(`${greeting} ${user.name}!`, 'success', 3000);
        console.log(`ğŸ‘‹ ${greeting} ${user.name}`);
    }
}

// ============================================
// ØªØµØ¯ÙŠØ± Ø§Ù„Ø¯ÙˆØ§Ù„
// ============================================

// ØªØµØ¯ÙŠØ± Ø§Ù„Ø¯ÙˆØ§Ù„ Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ
if (typeof window !== 'undefined') {
    window.initializeDashboard = initializeDashboard;
    window.refreshDashboard = refreshDashboard;
    window.updateDashboardUI = updateDashboardUI;
    window.loadDashboardData = loadDashboardData;
    
    console.log('ğŸ“¤ ØªÙ… ØªØµØ¯ÙŠØ± Ø¯ÙˆØ§Ù„ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…');
}
