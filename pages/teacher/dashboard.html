<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ููุญุฉ ุชุญูู ุงููุนูู - ููุณุฑ ุงูุชุนูู</title>
    <link rel="stylesheet" href="../../assets/css/main.css">
    <link rel="stylesheet" href="../../assets/css/teacher.css">
</head>
<body>
    <div class="dashboard-container">
        <!-- ุงูุดุฑูุท ุงูุฌุงูุจู -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <h2>๐จโ๐ซ ููุณุฑ ุงูุชุนูู</h2>
                </div>
            </div>
            <ul class="sidebar-menu" id="teacherMenu">
                <!-- ุณูุชู ุชุนุจุฆุชู ุจุงูุฌุงูุงุณูุฑูุจุช -->
            </ul>
        </div>

        <!-- ุงููุญุชูู ุงูุฑุฆูุณู -->
        <div class="main-content-dashboard">
            <header class="dashboard-header">
                <button class="mobile-menu-btn" onclick="toggleSidebar()">โฐ</button>
                <div class="user-info">
                    <div class="user-welcome">
                        <div class="welcome-text">ูุฑุญุจุงู ุจุนูุฏุชู</div>
                        <div class="user-name" id="teacherName">ุงููุนูู</div>
                    </div>
                    <div class="user-avatar" id="teacherAvatar">ู</div>
                </div>
                <div class="header-actions">
                    <button class="btn btn-primary btn-icon" onclick="showNotifications()">
                        ๐ <span class="notification-badge" id="notificationCount">0</span>
                    </button>
                    <button class="btn btn-secondary" onclick="logout()">ุชุณุฌูู ุงูุฎุฑูุฌ</button>
                </div>
            </header>

            <main class="dashboard-content">
                <div class="content-header">
                    <h1>ููุญุฉ ุชุญูู ุงููุนูู</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="showQuickAddStudent()">
                            โ ุฅุถุงูุฉ ุทุงูุจ ุฌุฏูุฏ
                        </button>
                    </div>
                </div>

                <!-- ุงูุจุทุงูุงุช ุงูุฅุญุตุงุฆูุฉ -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-header">
                            <div>
                                <div class="stat-number" id="studentsCount">0</div>
                                <div class="stat-label">ุฅุฌูุงูู ุงูุทูุงุจ</div>
                            </div>
                            <div class="stat-icon">๐จโ๐</div>
                        </div>
                    </div>
                    
                    <div class="stat-card success">
                        <div class="stat-header">
                            <div>
                                <div class="stat-number" id="activeTests">0</div>
                                <div class="stat-label">ุงุฎุชุจุงุฑุงุช ูุดุทุฉ</div>
                            </div>
                            <div class="stat-icon">๐</div>
                        </div>
                    </div>
                    
                    <div class="stat-card warning">
                        <div class="stat-header">
                            <div>
                                <div class="stat-number" id="pendingAssignments">0</div>
                                <div class="stat-label">ูุงุฌุจุงุช ููุฏ ุงููุฑุงุฌุนุฉ</div>
                            </div>
                            <div class="stat-icon">๐</div>
                        </div>
                    </div>
                    
                    <div class="stat-card danger">
                        <div class="stat-header">
                            <div>
                                <div class="stat-number" id="urgentActions">0</div>
                                <div class="stat-label">ุฅุฌุฑุงุกุงุช ุนุงุฌูุฉ</div>
                            </div>
                            <div class="stat-icon">โ๏ธ</div>
                        </div>
                    </div>
                </div>

                <!-- ุงูุฅุฌุฑุงุกุงุช ุงูุณุฑูุนุฉ -->
                <div class="quick-actions">
                    <h2>ุงูุฅุฌุฑุงุกุงุช ุงูุณุฑูุนุฉ</h2>
                    <div class="actions-grid">
                        <div class="action-card" onclick="window.location.href='diagnostic-tests.html'">
                            <div class="action-icon">๐</div>
                            <div class="action-title">ุงูุงุฎุชุจุงุฑุงุช ุงูุชุดุฎูุตูุฉ</div>
                            <div class="action-description">
                                ุฅูุดุงุก ูุฅุฏุงุฑุฉ ุงูุงุฎุชุจุงุฑุงุช ุงูุชุดุฎูุตูุฉ ููุทูุงุจ
                            </div>
                        </div>
                        
                        <div class="action-card" onclick="window.location.href='students.html'">
                            <div class="action-icon">๐จโ๐</div>
                            <div class="action-title">ุฅุฏุงุฑุฉ ุงูุทูุงุจ</div>
                            <div class="action-description">
                                ุนุฑุถ ูุชุนุฏูู ูุฅุถุงูุฉ ุทูุงุจ ุฌุฏุฏ
                            </div>
                        </div>
                        
                        <div class="action-card" onclick="window.location.href='library.html'">
                            <div class="action-icon">๐</div>
                            <div class="action-title">ุงููุญุชูู ุงูุชุนูููู</div>
                            <div class="action-description">
                                ุงููุตูู ุฅูู ููุชุจุฉ ุงููุญุชูู ุงูุชุนูููู
                            </div>
                        </div>
                        
                        <div class="action-card" onclick="window.location.href='assignments.html'">
                            <div class="action-icon">๐</div>
                            <div class="action-title">ุงููุงุฌุจุงุช ูุงูุงุฎุชุจุงุฑุงุช</div>
                            <div class="action-description">
                                ุฅูุดุงุก ูุชุตุญูุญ ุงููุงุฌุจุงุช ูุงูุงุฎุชุจุงุฑุงุช
                            </div>
                        </div>
                        
                        <div class="action-card" onclick="window.location.href='reports.html'">
                            <div class="action-icon">๐</div>
                            <div class="action-title">ุงูุชูุงุฑูุฑ ูุงูุฅุญุตุงุฆูุงุช</div>
                            <div class="action-description">
                                ุชูุงุฑูุฑ ุฃุฏุงุก ุงูุทูุงุจ ูุงูุฅุญุตุงุฆูุงุช
                            </div>
                        </div>
                        
                        <div class="action-card" onclick="window.location.href='schedule.html'">
                            <div class="action-icon">๐๏ธ</div>
                            <div class="action-title">ุงูุฌุฏูู ุงูุฏุฑุงุณู</div>
                            <div class="action-description">
                                ุฅุฏุงุฑุฉ ุงูุฌุฏูู ุงูุฏุฑุงุณู ูุงูุญุตุต
                            </div>
                        </div>
                        
                        <div class="action-card" onclick="window.location.href='messages.html'">
                            <div class="action-icon">๐ฌ</div>
                            <div class="action-title">ุงููุฑุงุณูุงุช</div>
                            <div class="action-description">
                                ุงูุชูุงุตู ูุน ุงูุทูุงุจ ูุฃูููุงุก ุงูุฃููุฑ
                            </div>
                        </div>
                        
                        <div class="action-card" onclick="window.location.href='iep.html'">
                            <div class="action-icon">๐</div>
                            <div class="action-title">ุงูุฎุทุท ุงูุชุฑุจููุฉ</div>
                            <div class="action-description">
                                ุฅุฏุงุฑุฉ ุงูุฎุทุท ุงูุชุฑุจููุฉ ุงููุฑุฏูุฉ
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ูุณููู ุฌูุจูุง ุฅูู ุฌูุจ -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin-top: 30px;">
                    <!-- ุงูุทูุงุจ ุงููููุฒูู -->
                    <div class="featured-students">
                        <div class="section-header">
                            <h2>ุงูุทูุงุจ ุงููููุฒูู</h2>
                            <button class="btn btn-sm btn-primary" onclick="window.location.href='students.html'">
                                ุนุฑุถ ุงููู
                            </button>
                        </div>
                        <div class="students-list" id="featuredStudentsList">
                            <!-- ุณูุชู ุชุนุจุฆุชู ุจุงูุฌุงูุงุณูุฑูุจุช -->
                        </div>
                    </div>

                    <!-- ุงูุฅุดุนุงุฑุงุช ุงููููุฉ -->
                    <div class="important-notices">
                        <div class="section-header">
                            <h2>ุงูุฅุดุนุงุฑุงุช ุงููููุฉ</h2>
                            <button class="btn btn-sm btn-primary" onclick="showAllNotifications()">
                                ุนุฑุถ ุงููู
                            </button>
                        </div>
                        <div class="notices-list" id="importantNoticesList">
                            <!-- ุณูุชู ุชุนุจุฆุชู ุจุงูุฌุงูุงุณูุฑูุจุช -->
                        </div>
                    </div>
                </div>

                <!-- ุงููุดุงุท ุงูุฃุฎูุฑ -->
                <div class="recent-activity" style="margin-top: 30px;">
                    <h2>ุงููุดุงุท ุงูุฃุฎูุฑ</h2>
                    <div class="activity-list" id="recentActivityList">
                        <!-- ุณูุชู ุชุนุจุฆุชู ุจุงูุฌุงูุงุณูุฑูุจุช -->
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- ูุงูุฐุฉ ุฅุถุงูุฉ ุทุงูุจ ุณุฑูุน -->
    <div id="quickAddStudentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ุฅุถุงูุฉ ุทุงูุจ ุฌุฏูุฏ</h3>
                <button class="modal-close" onclick="closeQuickAddStudentModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="quickAddStudentForm">
                    <div class="form-group">
                        <label for="studentName">ุงุณู ุงูุทุงูุจ *</label>
                        <input type="text" id="studentName" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="studentGrade">ุงูุตู ุงูุฏุฑุงุณู</label>
                        <select id="studentGrade" class="form-control">
                            <option value="">ุงุฎุชุฑ ุงูุตู</option>
                            <option value="ุงูุตู ุงูุฃูู">ุงูุตู ุงูุฃูู</option>
                            <option value="ุงูุตู ุงูุซุงูู">ุงูุตู ุงูุซุงูู</option>
                            <option value="ุงูุตู ุงูุซุงูุซ">ุงูุตู ุงูุซุงูุซ</option>
                            <option value="ุงูุตู ุงูุฑุงุจุน">ุงูุตู ุงูุฑุงุจุน</option>
                            <option value="ุงูุตู ุงูุฎุงูุณ">ุงูุตู ุงูุฎุงูุณ</option>
                            <option value="ุงูุตู ุงูุณุงุฏุณ">ุงูุตู ุงูุณุงุฏุณ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="studentSubject">ุงููุงุฏุฉ</label>
                        <select id="studentSubject" class="form-control">
                            <option value="">ุงุฎุชุฑ ุงููุงุฏุฉ</option>
                            <option value="ูุบุชู">ูุบุชู</option>
                            <option value="ุฑูุงุถูุงุช">ุฑูุงุถูุงุช</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeQuickAddStudentModal()">ุฅูุบุงุก</button>
                <button class="btn btn-success" onclick="quickAddStudent()">ุฅุถุงูุฉ</button>
            </div>
        </div>
    </div>

    <script src="../../assets/js/auth.js"></script>
    <script src="../../assets/js/teacher.js"></script>
    <script>
        // ุงูุชุญูู ูู ุชุณุฌูู ุงูุฏุฎูู ูุชููุฆุฉ ุงูุตูุญุฉ
        document.addEventListener('DOMContentLoaded', function() {
            const user = checkAuth();
            if (!user || user.role !== 'teacher') {
                window.location.href = '../../index.html';
                return;
            }

            // ุชุญุฏูุซ ูุงุฌูุฉ ุงููุณุชุฎุฏู
            updateTeacherInterface(user);
            
            // ุชุญููู ุงูุจูุงูุงุช
            loadTeacherStats();
            loadFeaturedStudents();
            loadImportantNotices();
            loadRecentActivity();
            setupTeacherMenu();
        });

        function updateTeacherInterface(user) {
            document.getElementById('teacherName').textContent = user.name;
            document.getElementById('teacherAvatar').textContent = user.name.charAt(0);
        }

        function loadTeacherStats() {
            // ูุญุงูุงุฉ ุชุญููู ุงูุฅุญุตุงุฆูุงุช
            setTimeout(() => {
                const students = JSON.parse(localStorage.getItem('students') || '[]');
                const currentTeacher = getCurrentUser();
                
                // ุชุตููุฉ ุทูุงุจ ุงููุนูู ุงูุญุงูู
                const teacherStudents = students.filter(student => student.teacherId === currentTeacher.id);
                
                // ุงุฎุชุจุงุฑุงุช ุงููุนูู ุงูุญุงูู
                const tests = JSON.parse(localStorage.getItem('diagnosticTests') || '[]');
                const teacherTests = tests.filter(test => test.createdBy === currentTeacher.id);
                
                // ุงููุงุฌุจุงุช ุงูููุฏ ุงููุฑุงุฌุนุฉ
                const assignments = JSON.parse(localStorage.getItem('assignments') || '[]');
                const pendingAssignments = assignments.filter(assignment => 
                    assignment.teacherId === currentTeacher.id && 
                    assignment.status === 'pending'
                );
                
                document.getElementById('studentsCount').textContent = teacherStudents.length;
                document.getElementById('activeTests').textContent = teacherTests.length;
                document.getElementById('pendingAssignments').textContent = pendingAssignments.length;
                document.getElementById('urgentActions').textContent = Math.floor(Math.random() * 3);
                document.getElementById('notificationCount').textContent = Math.floor(Math.random() * 5);
            }, 1000);
        }

        function loadFeaturedStudents() {
            const studentsList = document.getElementById('featuredStudentsList');
            const students = JSON.parse(localStorage.getItem('students') || '[]');
            const currentTeacher = getCurrentUser();
            
            // ุชุตููุฉ ุทูุงุจ ุงููุนูู ุงูุญุงูู
            const teacherStudents = students.filter(student => student.teacherId === currentTeacher.id);
            
            // ุงุฎุชูุงุฑ ุฃูุถู 4 ุทูุงุจ ุญุณุจ ุงูุชูุฏู
            const featuredStudents = teacherStudents
                .sort((a, b) => (b.progress || 0) - (a.progress || 0))
                .slice(0, 4);
            
            if (featuredStudents.length === 0) {
                studentsList.innerHTML = `
                    <div class="empty-state" style="padding: 20px;">
                        <div class="empty-icon">๐จโ๐</div>
                        <h4>ูุง ุชูุฌุฏ ุทูุงุจ</h4>
                        <p>ูู ุจุฅุถุงูุฉ ุทูุงุจ ูุชุจุฏุฃ ุงูุนูู</p>
                    </div>
                `;
                return;
            }
            
            studentsList.innerHTML = featuredStudents.map(student => `
                <div class="student-card" onclick="window.location.href='student-profile.html?id=${student.id}'">
                    <div class="student-avatar">${student.name.charAt(0)}</div>
                    <div class="student-name">${student.name}</div>
                    <div class="student-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${student.progress || 0}%"></div>
                        </div>
                        <span>${student.progress || 0}% ุชูุฏู</span>
                    </div>
                </div>
            `).join('');
        }

        function loadImportantNotices() {
            const noticesList = document.getElementById('importantNoticesList');
            
            const notices = [
                {
                    icon: '๐',
                    title: 'ููุนุฏ ุชุณููู ุงููุงุฌุจุงุช',
                    description: 'ููุชูู ููุนุฏ ุชุณุฌูู ุฏุฑุฌุงุช ุงููุงุฌุจุงุช ูู ููุงูุฉ ุงูุฃุณุจูุน',
                    time: 'ููุฐ ููู'
                },
                {
                    icon: '๐',
                    title: 'ุชูุฑูุฑ ุดูุฑู',
                    description: 'ูุฑุฌู ูุฑุงุฌุนุฉ ุงูุชูุฑูุฑ ุงูุดูุฑู ูุฃุฏุงุก ุงูุทูุงุจ',
                    time: 'ููุฐ 3 ุฃูุงู'
                },
                {
                    icon: '๐ฅ',
                    title: 'ุงุฌุชูุงุน ูุฌูุฉ ุงูุตุนูุจุงุช',
                    description: 'ุงุฌุชูุงุน ุฏูุฑู ูุน ูุฌูุฉ ุตุนูุจุงุช ุงูุชุนูู ุบุฏุงู',
                    time: 'ุบุฏุงู'
                }
            ];
            
            noticesList.innerHTML = notices.map(notice => `
                <div class="notice-item">
                    <div class="notice-icon">${notice.icon}</div>
                    <div class="notice-content">
                        <div class="notice-title">${notice.title}</div>
                        <div class="notice-description">${notice.description}</div>
                    </div>
                    <div class="notice-time">${notice.time}</div>
                </div>
            `).join('');
        }

        function loadRecentActivity() {
            const activityList = document.getElementById('recentActivityList');
            
            const activities = [
                {
                    icon: '๐จโ๐',
                    title: 'ุชู ุชุณุฌูู ุทุงูุจ ุฌุฏูุฏ',
                    description: 'ุงูุทุงูุจ ุฃุญูุฏ ูุญูุฏ ุชู ุชุณุฌููู ูู ุงููุธุงู',
                    time: 'ููุฐ ุณุงุนุชูู'
                },
                {
                    icon: '๐',
                    title: 'ุชู ุชูุฏูู ูุงุฌุจ',
                    description: 'ุงูุทุงูุจ ุณุนุฏ ูุฏู ูุงุฌุจ ุฏุฑุณ ุงูุฌูุน',
                    time: 'ููุฐ 4 ุณุงุนุงุช'
                },
                {
                    icon: '๐',
                    title: 'ุงุฎุชุจุงุฑ ุชุดุฎูุตู ุฌุฏูุฏ',
                    description: 'ุชู ุฅูุดุงุก ุงุฎุชุจุงุฑ ุชุดุฎูุตู ููุงุฏุฉ ุงูุฑูุงุถูุงุช',
                    time: 'ููุฐ ููู'
                },
                {
                    icon: '๐ฌ',
                    title: 'ุฑุณุงูุฉ ุฌุฏูุฏุฉ',
                    description: 'ุฑุณุงูุฉ ูู ููู ุฃูุฑ ุงูุทุงูุจ ุฎุงูุฏ',
                    time: 'ููุฐ ููููู'
                }
            ];
            
            activityList.innerHTML = activities.map(activity => `
                <div class="activity-item">
                    <div class="activity-icon">${activity.icon}</div>
                    <div class="activity-content">
                        <div class="activity-title">${activity.title}</div>
                        <div class="activity-description">${activity.description}</div>
                    </div>
                    <div class="activity-time">${activity.time}</div>
                </div>
            `).join('');
        }

        function setupTeacherMenu() {
            const menuItems = [
                {
                    icon: '๐',
                    text: 'ููุญุฉ ุงูุชุญูู',
                    href: 'dashboard.html'
                },
                {
                    icon: '๐',
                    text: 'ุงูุงุฎุชุจุงุฑุงุช ุงูุชุดุฎูุตูุฉ',
                    href: 'diagnostic-tests.html'
                },
                {
                    icon: '๐จโ๐',
                    text: 'ุงูุทูุงุจ',
                    href: 'students.html'
                },
                {
                    icon: '๐',
                    text: 'ุงููุญุชูู ุงูุชุนูููู',
                    href: 'library.html'
                },
                {
                    icon: '๐',
                    text: 'ุงููุงุฌุจุงุช ูุงูุงุฎุชุจุงุฑุงุช',
                    href: 'assignments.html'
                },
                {
                    icon: '๐',
                    text: 'ุงูุชูุงุฑูุฑ ูุงูุฅุญุตุงุฆูุงุช',
                    href: 'reports.html'
                },
                {
                    icon: '๐๏ธ',
                    text: 'ุงูุฌุฏูู ุงูุฏุฑุงุณู',
                    href: 'schedule.html'
                },
                {
                    icon: '๐ฌ',
                    text: 'ุงููุฑุงุณูุงุช',
                    href: 'messages.html'
                },
                {
                    icon: '๐',
                    text: 'ุงูุฎุทุท ุงูุชุฑุจููุฉ',
                    href: 'iep.html'
                },
                {
                    icon: '๐ฅ',
                    text: 'ูุฌูุฉ ุงูุตุนูุจุงุช',
                    href: 'committee.html'
                },
                {
                    icon: 'โ๏ธ',
                    text: 'ุงูุฅุนุฏุงุฏุงุช',
                    href: 'settings.html'
                }
            ];
            
            const menuList = document.getElementById('teacherMenu');
            if (menuList) {
                menuList.innerHTML = menuItems.map(item => {
                    const isActive = window.location.pathname.includes(item.href);
                    return `
                        <li>
                            <a href="${item.href}" class="${isActive ? 'active' : ''}">
                                <span class="menu-icon">${item.icon}</span>
                                <span>${item.text}</span>
                            </a>
                        </li>
                    `;
                }).join('');
            }
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('active');
        }

        function showQuickAddStudent() {
            document.getElementById('quickAddStudentModal').classList.add('show');
        }

        function closeQuickAddStudentModal() {
            document.getElementById('quickAddStudentModal').classList.remove('show');
            document.getElementById('quickAddStudentForm').reset();
        }

        function quickAddStudent() {
            const name = document.getElementById('studentName').value.trim();
            const grade = document.getElementById('studentGrade').value;
            const subject = document.getElementById('studentSubject').value;
            
            if (!name) {
                showAuthNotification('ูุฑุฌู ุฅุฏุฎุงู ุงุณู ุงูุทุงูุจ', 'error');
                return;
            }
            
            const currentTeacher = getCurrentUser();
            const students = JSON.parse(localStorage.getItem('students') || '[]');
            
            // ุชูููุฏ ุงุณู ูุณุชุฎุฏู ููููุฉ ูุฑูุฑ ุชููุงุฆู
            const username = `student_${Date.now()}`;
            const password = 'student123';
            
            const newStudent = {
                id: generateId(),
                username: username,
                password: password,
                role: 'student',
                name: name,
                grade: grade || '',
                subject: subject || '',
                teacherId: currentTeacher.id,
                progress: 0,
                status: 'active',
                createdAt: new Date().toISOString(),
                lastLogin: null
            };
            
            students.push(newStudent);
            localStorage.setItem('students', JSON.stringify(students));
            
            showAuthNotification('ุชู ุฅุถุงูุฉ ุงูุทุงูุจ ุจูุฌุงุญ', 'success');
            closeQuickAddStudentModal();
            loadTeacherStats();
            loadFeaturedStudents();
        }

        function showNotifications() {
            alert('ุตูุญุฉ ุงูุฅุดุนุงุฑุงุช ุณุชููู ูุชุงุญุฉ ูู ุงูุชุญุฏูุซุงุช ุงููุงุฏูุฉ');
        }

        function showAllNotifications() {
            alert('ุนุฑุถ ุฌููุน ุงูุฅุดุนุงุฑุงุช');
        }
    </script>
</body>
</html>
